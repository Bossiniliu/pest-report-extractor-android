# 🚀 快速入门 v2.0

## 第一次使用（5分钟上手）

### 步骤1：安装依赖

打开终端（Terminal），运行：

```bash
pip3 install pdfplumber openpyxl pandas
```

### 步骤2：运行脚本

#### macOS用户（推荐）：

```bash
# 方法A：GUI模式（会弹出文件选择窗口）
python3 pest_report_extractor.py

# 方法B：命令行模式（生成分析报告）
python3 pest_report_extractor.py --pdf "你的PDF文件路径.pdf" --report --open
```

### 步骤3：查看结果

Excel文件会自动生成在桌面上，文件名类似：
```
虫害情况报告_20251107_160731.xlsx
```

**文件包含两个工作表：**
1. **虫害情况** - 原始数据表
2. **数据分析报告** - 统计分析（新增）

## 🆕 v2.0 新功能亮点

### 自动生成可视化报告

运行脚本时，可以选择生成分析报告，报告包含：

✨ **数据概览卡片**
- 总记录数、虫害总数
- 平均密度、最大单点（高亮警告）

📊 **虫害类型统计**
- 每种虫害的记录数、总数量、占比

🏢 **建筑物统计**
- 各建筑物的虫害分布和占比

⚠️ **高危区域TOP10**
- 按虫害数量排名
- 前三名高亮显示

## 📱 macOS快捷使用技巧

### 技巧1：拖拽文件到终端

1. 在终端输入：`python3 pest_report_extractor.py --pdf `（注意最后有空格）
2. 从Finder拖拽PDF文件到终端窗口
3. 按回车

### 技巧2：设置别名（可选）

在`~/.zshrc`或`~/.bash_profile`添加：

```bash
alias pest='python3 /path/to/pest_report_extractor.py'
```

之后可以直接使用：
```bash
pest --pdf report.pdf --open
```

## 🎯 典型使用场景

### 场景1：快速数据提取（不生成报告）
```bash
python3 pest_report_extractor.py --pdf 虫害报告.pdf --open
```
→ 仅提取数据，不生成分析报告

### 场景2：完整分析（推荐）
```bash
python3 pest_report_extractor.py --pdf 虫害报告.pdf --report --open
```
→ 提取数据 + 生成分析报告，并自动打开

### 场景3：批量处理多个PDF（含报告）
```bash
for file in ~/Downloads/*.pdf; do
    python3 pest_report_extractor.py --pdf "$file" --output ~/Desktop/虫害报告 --report
done
```
→ 所有Excel文件（含分析报告）保存在 ~/Desktop/虫害报告

### 场景4：GUI交互模式
```bash
python3 pest_report_extractor.py
```
→ 1. 选择PDF文件
→ 2. 询问是否生成报告
→ 3. 询问是否打开文件

## 💡 实用技巧

1. **查看脚本帮助**：
   ```bash
   python3 pest_report_extractor.py --help
   ```

2. **测试运行（看提取了多少数据）**：
   脚本会自动显示统计信息，包括：
   - 提取的记录数
   - 各建筑物分布
   - 各虫害类型统计

3. **如果遇到错误**：
   检查PDF是否包含文字（不是扫描版图片）

## ✅ 验证输出正确性

脚本会自动进行5项验证：
1. ✅ 数量一致性
2. ✅ 字段完整性  
3. ✅ 无空值
4. ✅ 逐条数据准确性
5. ✅ 统计信息

如果验证全部通过，说明数据提取100%准确！

## 📊 分析报告说明

生成的报告工作表包含：

**概览指标**
- 总记录数：28条
- 虫害总数：92只
- 平均密度：3.3只/处
- 最大单点：18只 ⚠️

**详细统计**
- 虫害类型分布（含占比）
- 建筑物分布（含占比）
- 高危区域TOP10排名

## 🎉 开始使用吧！

最简单的方式（生成完整报告）：
```bash
python3 pest_report_extractor.py --report
```

然后选择你的PDF文件，等待几秒钟，完成！
