# 📊 如何查看数据分析报告

## 重要提示 ⚠️

生成的Excel文件包含**两个工作表**，请确保您查看了正确的工作表！

## 📂 Excel文件结构

打开Excel文件后，您会在**底部**看到两个工作表标签：

```
┌─────────────────────────────────────────────┐
│                                             │
│         Excel 文件内容区域                   │
│                                             │
└─────────────────────────────────────────────┘
  ┌──────────────┐  ┌──────────┐
  │数据分析报告  │  │虫害情况   │   ← 工作表标签（在Excel窗口底部）
  └──────────────┘  └──────────┘
```

## 📋 两个工作表的区别

### 工作表1：数据分析报告 ⭐ **这就是您要找的报告**
- 位置：第一个标签
- 内容：
  - 📊 数据概览（总记录数、虫害总数、平均密度、最大单点）
  - 📈 虫害类型统计表
  - 🏢 建筑物虫害统计表
  - ⚠️ 高危区域TOP10排名

### 工作表2：虫害情况
- 位置：第二个标签
- 内容：原始虫害数据（28条记录）

## 🔍 如何切换查看报告

### 方法一：点击工作表标签
1. 打开Excel文件
2. 看到Excel窗口**底部**的标签栏
3. 点击 **"数据分析报告"** 标签
4. 即可看到完整的分析报告

### 方法二：使用键盘快捷键
- **macOS**: `Control + Page Down` 或 `Control + Page Up` 切换工作表
- **Windows**: `Ctrl + Page Down` 或 `Ctrl + Page Up` 切换工作表

## ✅ 验证报告是否存在

打开Excel后，请检查：

1. **底部标签栏**是否显示两个标签？
   - ✅ 是 → 报告已生成
   - ❌ 否 → 报告未生成（请使用 `--report` 参数重新运行）

2. 点击"数据分析报告"标签后，是否看到：
   - 标题"虫害情况数据概览"
   - 概览数据卡片
   - 统计表格
   - TOP10排名

## 📸 报告内容示例

### 数据概览部分
```
虫害情况数据概览

总记录数      虫害总数      平均密度      ⚠️ 最大单点
28 条        92 只       3.3 只/处     18 只
```

### 虫害类型统计表
```
虫害类型统计

虫害类型  | 记录数 | 总数量（只） | 占比
---------|--------|--------------|-------
绿化飞虫  |   13   |     53       | 57.6%
飞蛾     |    8   |     28       | 30.4%
蚊子     |    4   |      8       | 8.7%
苍蝇     |    3   |      3       | 3.3%
```

### 建筑物统计表
```
建筑物虫害统计

建筑物    | 记录数 | 总数量（只） | 占比
---------|--------|--------------|-------
CA栋     |   24   |     78       | 84.8%
泽润     |    2   |     11       | 12.0%
危险品库  |    2   |      3       | 3.3%
```

### 高危区域TOP10
```
高危区域分析 - TOP 10

排名 | 建筑物 | 楼层   | 部门    | 监测点位 | 虫害类型  | 数量
-----|--------|--------|---------|----------|-----------|------
1    | CA栋   | 1F-3F  | 公共区域 | F112     | 绿化飞虫  | 18
2    | CA栋   | 1F-3F  | 办公区   | F090     | 绿化飞虫  | 8
3    | 泽润   | 1      | 泽润    | F-147    | 飞蛾      | 6
...
```

## 🆘 如果看不到报告

### 情况1：只看到一个工作表"虫害情况"
**原因**：运行脚本时未使用 `--report` 参数

**解决方法**：
```bash
# 重新运行脚本，添加 --report 参数
python3 pest_report_extractor.py --pdf "你的PDF.pdf" --report
```

### 情况2：Excel底部没有工作表标签
**原因**：工作表标签栏被隐藏了

**解决方法**：
- **Excel for Mac**: 顶部菜单 → 视图 → 显示工作表标签
- **Excel for Windows**: 文件 → 选项 → 高级 → 显示工作表标签

### 情况3：确认是否真的生成了报告
运行脚本后，查看输出信息：

✅ **包含报告** - 会显示：
```
📈 步骤4: 生成分析报告
✅ 分析报告已添加到工作表: 数据分析报告
📊 分析报告已包含在Excel文件中
```

❌ **不包含报告** - 会跳过这一步：
```
🔍 步骤4: 验证数据
```

## 💡 快速测试

下载示例文件：[虫害情况报告_完整示例.xlsx]

打开后：
1. 查看底部 - 应该有2个标签
2. 点击"数据分析报告"标签
3. 看到4个分析模块

如果您能看到完整内容，说明：
- ✅ Excel正常
- ✅ 知道如何查看报告
- ✅ 可以开始使用脚本了

## 🚀 推荐使用方式

为了确保每次都生成报告，建议使用：

```bash
# 推荐命令（总是生成报告）
python3 pest_report_extractor.py --pdf "文件.pdf" --report --open
```

这样可以：
- ✅ 自动生成分析报告
- ✅ 处理完成后自动打开
- ✅ 直接看到完整结果

---

**如有问题，请提供：**
1. 运行脚本时的完整输出
2. Excel文件底部标签的截图
3. 使用的命令
