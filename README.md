# 虫害情况数据提取工具包 v2.0

## 🆕 v2.0 新功能

✨ **自动生成数据分析报告**
- 数据概览（总记录数、虫害总数、平均密度、最大单点）
- 虫害类型统计（记录数、总数量、占比）
- 建筑物虫害统计（记录数、总数量、占比）  
- 高危区域TOP10分析（排名、位置、数量）

## 📦 文件清单

### 1. 核心工具 (2个)
- **pest_report_extractor.py** - 主程序脚本 v2.0（推荐使用）
- **pest_report_extractor_v2.0_final.py** - 标注版本号的副本（内容相同）
  - 支持GUI和命令行两种模式
  - 自动提取、转换、生成报告、验证数据
  - 支持macOS、Windows、Linux

### 2. 示例输出 (1个)
- **虫害情况报告_完整示例.xlsx** - 完整示例Excel文件
  - **工作表1**：数据分析报告（新增，44行）⭐
  - **工作表2**：虫害情况（28条记录）
  - 格式化表格，包含边框和表头
  - 已通过5项验证测试

### 3. 使用文档 (7个)
- **README.md** - 项目总览（当前文档）
- **快速入门.md** - 5分钟上手指南
- **使用说明.md** - 完整使用文档
- **更新日志.md** - 版本更新记录
- **代码功能说明.md** - 代码架构和功能详解 ⭐ 新增
- **代码快速参考.md** - 命令速查手册 ⭐ 新增
- **如何查看报告.md** - 报告查看指南 ⭐ 新增
- **v2.0完成总结.md** - 本次更新总结

## 🎯 核心功能

### ✨ 自动化流程
1. **PDF解析** - 自动识别虫害情况部分
2. **数据提取** - 提取建筑物、楼层、部门、点位、虫害类型、数量
3. **Excel生成** - 生成格式化的Excel表格
4. **报告生成** ⭐新增 - 自动生成数据分析报告
5. **数据验证** - 执行5项完整性验证

### 📊 数据输出

**工作表1：虫害情况（原始数据）**
```
建筑物 | 楼层 | 部门 | 检查/发现监测点位 | 虫害类型 | 发现虫害活动
-------|------|------|------------------|---------|------------
泽润   | 1    | 泽润 | F-147            | 绿化飞虫 | 5
...
```

**工作表2：数据分析报告（新增）** ⭐
- 📊 数据概览卡片（4个关键指标）
- 📈 虫害类型统计表（含占比）
- 🏢 建筑物统计表（含占比）
- ⚠️ 高危区域TOP10排名（前三名高亮）

### ✅ 自动验证
- 记录数量验证
- 字段完整性验证
- 数据完整性验证（无空值）
- 逐条数据对比验证
- 统计信息验证

## 🚀 快速开始

### 最简单的使用方式（macOS）

```bash
# 1. 安装依赖
pip3 install pdfplumber openpyxl pandas

# 2. GUI模式（会弹窗询问是否生成报告）
python3 pest_report_extractor.py

# 3. 命令行模式（生成完整报告）
python3 pest_report_extractor.py --pdf "你的PDF.pdf" --report --open
```

### 新功能：生成分析报告

```bash
# 生成包含分析报告的Excel
python3 pest_report_extractor.py --pdf report.pdf --report

# 或在GUI模式中选择"是"来生成报告
python3 pest_report_extractor.py
```

## 📈 测试结果

使用示例PDF测试v2.0版本：

**数据提取**
- ✅ 28条虫害活动记录
- ✅ 4种虫害类型（绿化飞虫13次、飞蛾8次、蚊子4次、苍蝇3次）
- ✅ 3个建筑区域（CA栋、泽润、危险品库）
- ✅ 虫害活动总数：92只

**分析报告** ⭐新增
- ✅ 平均密度：3.3只/处
- ✅ 最大单点：18只（自动高亮警告）
- ✅ 虫害类型占比统计
- ✅ 建筑物分布统计
- ✅ 高危区域TOP10排名

## 💡 使用建议

### 适用场景
✅ 定期虫害报告处理  
✅ 批量PDF文件转换  
✅ 数据统计和分析  
✅ 报告归档和备份  

### 不适用场景
❌ 扫描版PDF（纯图片）  
❌ 非标准格式的报告  
❌ 需要OCR的文档  

## 📚 文档说明

1. **新手请先阅读**：`快速入门.md`
2. **详细功能说明**：`使用说明.md`
3. **示例参考**：`虫害情况报告_20251107_103025.xlsx`

## 🔧 技术特点

- **纯Python实现** - 无需额外软件
- **跨平台支持** - macOS/Windows/Linux
- **GUI可选** - 支持图形界面和命令行
- **自动验证** - 5项验证确保数据准确
- **可视化报告** ⭐新增 - 自动生成统计分析
- **灵活输出** - 自定义输出目录
- **时间戳命名** - 避免文件覆盖

## 📞 获取帮助

```bash
python3 pest_report_extractor.py --help
```

---

**版本**：2.0  
**更新时间**：2025-11-07  
**测试状态**：✅ 已验证  
**支持格式**：PDF → Excel (XLSX)  
**新功能**：✨ 数据分析报告
