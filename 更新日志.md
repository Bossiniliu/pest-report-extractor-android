# 版本更新日志

## v2.0 (2025-11-07)

### 🆕 新功能

#### 自动生成数据分析报告
- ✨ 新增"数据分析报告"工作表
- 📊 数据概览卡片
  - 总记录数
  - 虫害总数
  - 平均密度（只/处）
  - 最大单点（带警告高亮）
- 📈 虫害类型统计表
  - 记录数、总数量、占比
  - 按数量降序排列
- 🏢 建筑物虫害统计表
  - 记录数、总数量、占比
  - 按数量降序排列
- ⚠️ 高危区域TOP10分析
  - 完整的监测点信息
  - 前三名高亮显示
  - 按虫害数量排名

#### 交互式报告生成
- GUI模式：询问用户是否生成报告
- 命令行模式：新增 `--report` 参数
- 灵活选择：可生成或跳过报告

### 🎨 样式优化

- 报告表格使用专业格式
- 关键数据高亮显示
- 清晰的分区布局
- 统一的颜色方案

### 📚 文档更新

- 更新使用说明.md（v2.0）
- 更新快速入门.md（v2.0）
- 更新README.md（v2.0）
- 新增版本更新日志

### 🔧 技术改进

- 更好的Excel工作表管理
- 优化的数据统计算法
- 改进的样式渲染
- 增强的错误处理

## v1.0 (2025-11-07)

### 🎉 首次发布

#### 核心功能
- PDF虫害数据自动提取
- Excel格式化输出
- 5项数据验证
- GUI和命令行双模式

#### 支持特性
- 跨平台支持（macOS/Windows/Linux）
- 自动文件命名
- 灵活输出目录
- 文件自动打开

#### 数据提取
- 建筑物信息
- 楼层和部门
- 监测点位
- 虫害类型和数量

---

## 使用说明

### 从 v1.0 升级到 v2.0

直接替换 `pest_report_extractor.py` 文件即可，向后兼容。

### v2.0 新参数

```bash
# 生成包含分析报告的Excel
python pest_report_extractor.py --pdf report.pdf --report

# 旧版命令仍然有效（不生成报告）
python pest_report_extractor.py --pdf report.pdf
```

### 推荐使用方式

```bash
# 完整功能（推荐）
python pest_report_extractor.py --pdf report.pdf --report --open
```

---

## 未来计划

### v2.1（规划中）
- [ ] 支持多个PDF批量处理的进度条
- [ ] 导出报告为独立PDF
- [ ] 添加趋势分析（需要多期数据）
- [ ] 自定义报告模板

### v3.0（远期规划）
- [ ] Web界面
- [ ] 数据库存储
- [ ] 历史数据对比
- [ ] 预警系统

---

## 反馈与建议

如有问题或建议，请提供：
1. 版本号
2. 问题描述
3. 示例PDF（如可能）
4. 错误信息截图

**当前版本**：v2.0  
**发布日期**：2025-11-07
